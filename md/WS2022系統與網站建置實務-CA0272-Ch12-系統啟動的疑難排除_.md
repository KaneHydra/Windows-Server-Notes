第 12 章 系統啟動的疑難排除

12\-1 選擇「上次的正確設定」來啟動系統

12\-2 安全模式與其他進階啟動選項

12\-3 備份與復原系統

# 12-1 選擇「上次的正確設定」來啟動系統

__系統設定__ 內儲存著設備驅動程式與服務等設定值

Windows系統啟動時會根據 __系統設定__ 來啟動設備驅動程式與服務

使用者登入成功的話，系統就會將目前的 __系統設定__ 儲存到 __上次的正確設定__ 內

下一次因故無法啟動Windows系統時，使用者就可以嘗試選用 __上次的正確設定__ 來啟動Windows系統

系統設定分為 __目前的系統設定__ 、 __預設系統設定__ 與 __上次的正確設定__

# 各種系統設定的關連性

* 電腦啟動時
  * 若使用者並未選擇 __上次的正確設定__
  * 利用 __預設系統設定__ 來啟動系統、 __預設系統設定__  __目前的系統設定__
  * 若使用者選擇 __上次的正確設定__ 來啟動Windows系統
  * 啟動成功後， __上次的正確設定__  __目前的系統設定__
* 使用者登入成功後， __目前的系統設定__  __上次的正確設定__
* 使用者登入成功後，其對系統設定的變更，都會被儲存到 __目前的系統設定__ 內，之後將電腦關機或重新啟動時， __目前的系統設定__ 內的設定值，都會被拷貝到 __預設系統設定__ ，以供下一次啟動Windows系統時來使用

\*	選用 __上次的正確設定__ 來啟動系統，並不會影響到使用者個人的檔案，例如電子郵件、相片檔等，它只會影響到系統設定

# 適合於選用「上次的正確設定」的場合

* 安裝新的設備驅動程式後，因而Windows 系統停止回應或無法啟動
* 有些關鍵性的設備驅動程式不應該被停用，否則系統將無法正常啟動。若不小心將這類驅動程式停用的話，此時可以選用 __上次的正確設定__ 來啟動Windows系統
  * 有些關鍵性的設備驅動程式或服務若無法啟動的話，系統會自動以 __上次的正確設定__ 來重新啟動Windows系統

* 所發生的問題並不是與系統設定有關
* 雖然系統啟動時有問題，但仍然可以啟動，而且使用者也登入成功
  * 此時 __目前的系統設定__ \(有問題的設定\) __上次的正確設定__ ，因此前一個 __上次的正確設定__ 也就遺失了
* 無法啟動的原因是因硬體故障或系統檔案損毀、遺失

# 如何選用「上次的正確設定」

* 執行以下指令
  * __bcdedit__  __  \-\-%  /set  \{__  __globalsettings__  __\}  __  __advancedoptions__  __  __  __true__
  * __bcdedit__  __  \-\-%  /set  \{__  __globalsettings__  __\}  __  __advancedoptions__  __  __  __false__
* 也可先執行 __bcdedit__  __ \-\-% /set \{__  __bootmgr__  __\} __  __displaybootmenu__  __ yes__ 指令，然後在出現 __Windows__  __開機管理程式__ 畫面時按F8鍵

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_0.png)

---

若以正常模式來啟動電腦的話，則即使會正常出現請按Ctrl + Alt + Delete 來登入的畫面，也不要登入，否則您想要選用的上次的正確設定會被覆蓋
若電腦內安裝多套Windows系統，請從清單中選擇欲利用上次的正確設定來啟動的作業系統

# 12-2 安全模式與其他進階啟動選項

修復您的電腦

安全模式

安全模式\(含網路功能\)

安全模式\(含命令提示字元\)

啟用開機記錄

啟用低解析度視訊

上一次的正確設定 \(進階\)

目錄服務修復模式

偵錯模式

停用系統失敗時自動重新啟動

停用驅動程式強制簽章

停用開機初期啟動的反惡意程式碼驅動程式

---

安全模式(含命令提示字元)：您可以輸入MMC後按Enter鍵，然後新增一個內含裝置管理員嵌入式管理單元的主控台，就可以利用滑鼠與裝置管理員來將有問題的設備驅動程式停用或移除


# 12-3 備份與復原系統

儲存在磁碟內的資料可能會因為天災、人禍、設備故障等因素而遺失，因此平常應定期備份磁碟，並將其存放在安全的地方，以便日後可以利用這些備份來迅速復原資料與讓系統正常運作

可以透過Windows Server Backup功能來備份磁碟

# 備份方式

* 完整伺服器備份
  * 備份此伺服器內所有磁碟內的所有檔案，包含應用程式與系統狀態
  * 可以利用它來將整台電腦復原，包含作業系統與所有其他檔案
* 自訂備份：可自行選擇欲備份的資料
  * 系統保留磁碟區
  * 一般磁碟區\(例如C:、D:\)
  * 磁碟區內指定的檔案
  * 系統狀態
  * 裸機還原備份
    * 備份整個作業系統，包含 __系統狀態__ 、 __系統保留磁碟區__ 與安裝作業系統的磁碟區
    * 可利用 __裸機還原__ 備份來還原整個作業系統

# 備份排程與一次性備份

* 備份排程
  * 在指定的時間到達時自動備份
  * 備份目的地可以選擇本機磁碟、USB或IEEE 1394外接式磁碟、網路共用資料夾
* 一次性備份
  * 手動執行單次備份
  * 備份目的地可以選擇本機磁碟、USB或IEEE 1394外接式磁碟、共用資料夾、DVD

# 安裝備份軟體

新增Windows Server Backup功能

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_1.png)

---

若要撰寫Windows PowerShell指令碼來執行備份工作的話，請增加勾選圖中的命令列工具

# 排程完整伺服器備份

也可以備份另一台電腦

時間是以半小時為單位，若要改用其他時間單位的話，請使用 __wbadmin__ 指令來備份

具備 __離站存放__ \(store disk offsite\)的功能

備份目的地磁碟將專用於儲存備份，故不會有磁碟機代號

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_2.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_3.png)

---

若要備份另一台伺服器的話，請透過按【+ R鍵執行MMC新增Windows Server Backup嵌入式管理單元】的途徑來選擇其他伺服器

# 離站存放

* 若選擇多個磁碟\(例如USB外接式磁碟\)來儲存備份的話，則具備 __離站存放__ 的功能
  * 資料備份到第1個磁碟內後、拿到其他地點存放
  * 下一次備份時，系統會自動備份到第2個磁碟內
  * 將第2個磁碟拿到其他地點存放、將之前的備份磁碟\(第1個磁碟\)帶回來裝好
* 輪流離站存放可以讓資料多一份保障

# 排程自訂備份

自行選擇要備份的項目，然後排定時程來備份這些項目

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_4.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_5.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_6.png)

# 一次性備份

* 排程備份選項
  * 選擇與排程備份相同的設定來備份，包括完整伺服器備份或自訂備份、備份時間、備份目的磁碟等

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_7.png)

* 不同選項
  * 重新選擇備份設定
  * 還可選擇備份到DVD或遠端共用資料夾

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_8.png)

# 復原檔案、資料夾、應用程式或磁碟區

利用所建立的備份來復原檔案、資料夾、應用程式、系統狀態或磁碟區

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_9.png)

---

若要復原應用程式與其資料的話，該應用程式需相容於Windows Server Backup

# 還原作業系統或整台電腦 - 1

* 執行以下bcdedit指令、重新開機，然後選用 __進階開機選項__ 中的 __修復您的__  __電腦__
  * __bcdedit__  __  \-\-%  /set  \{__  __globalsettings__  __\}  __  __advancedoptions__  __  true__
* 利用Windows Server 2022 USB隨身碟或DVD來啟動電腦、選擇 __修復您的電腦__

* 進階開機選項修復您的電腦正常啟動Windows
  * 準備好內含作業系統\(裸機還原\)或完整伺服器的備份

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_10.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_11.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_12.png)

* 利用Windows Server 2022 USB隨身碟或DVD啟動電腦
  * 準備好Windows Server 2022 USB隨身碟\(或DVD\)
  * 準備好內含作業系統\(裸機還原\)或完整伺服器的備份

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_13.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch12-%E7%B3%BB%E7%B5%B1%E5%95%9F%E5%8B%95%E7%9A%84%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4_14.png)

