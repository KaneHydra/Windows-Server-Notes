第 8 章 架設列印伺服器

8\-1 列印伺服器概觀

8\-2 設定列印伺服器

8\-3 使用者如何連接網路共用印表機

8\-4 共用印表機的進階設定

8\-5 印表機使用權限與擁有權

8\-6 利用分隔頁來區隔列印文件

8\-7 管理等待列印的文件

# 8-1 列印伺服器概觀

支援USB、IEEE 1394 \(firewire\)、無線、藍牙印表機、網路介面印表機與IEEE 1284平行埠印表機

支援利用網頁瀏覽器來連接與管理列印伺服器

Windows 用戶端所需的印表機驅動程式會自動從列印伺服器端下載與安裝

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_0.png)

---

實體印表機、邏輯印表機、列印伺服器、印表機驅動程式


![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_1.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_2.png)

# 8-2 設定列印伺服器

* 在一台電腦上安裝印表機，並將其設定為共用印表機
* 安裝 __網際網路列印__ 角色服務：
  * 可透過瀏覽器來連接或管理列印伺服器
  * 透過 __伺服器管理員__ 來新增 __列印和文件服務__ 角色

---

在一台Windows Server 2008或Windows Server 2008 R2電腦上新增列印伺服器角色服務

# 安裝USB、IEE1394等隨插即用印表機

直接將隨插即用印表機連接到USB、IEEE 1394連接埠

點擊左下角 __開始__ 圖示點擊 __設定__ 圖示裝置

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_3.png)

# 執行印表機管理工作，發生錯誤

* __Windows __  __無法存取指定的裝置、路徑或檔案。 您可能沒有適當的權限，所以無法存取項目__
  * 執行gpedit\.msc:
    * __電腦__  __設定__  ____  __Windows__  __設定__  ____  __安全性設定__  ____  __本機原則__  ____  __安全性__  __選項__  ____  __使用者__  __帳戶控制__  __: __  __使用內建的__  __ Administrator __  __帳戶的管理員核准模式__
  * 或【點擊左下角 __開始__ 圖示控制台點擊 __硬體__ 下的 __檢視裝置和印表機__ 】

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_4.png)

# 安裝網路介面印表機

內含網路卡

利用廠商所附程式或透過【點擊左下角 __開始__ 圖示點擊 __設定__ 圖示裝置印表機與掃描器點擊上方 __新增印表機或掃描器__  __】__ 來安裝

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_5.png)

# 將現有的印表機設定為共用印表機

* 印表機內容勾選 __共用這個印表機__
* 列入目錄
  * 將該印表機公佈到Active Directory，讓網域使用者可以透過Active Directory來找到這台印表機

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_6.png)

---

需在Active Directory網域環境之下，才有列入目錄的選項

# 利用「列印管理」來建立印表機

* 透過 __列印管理__ 來安裝與管理本機/網路共用印表機
  * 新增 __列印及文件服務__ 角色時會自動安裝 __列印管理__
* 可在其他電腦上僅安裝 __列印管理__ 主控台
  * 安裝 __遠端伺服器管理工具__ 內的 __列印和文件服務工具__ 角色管理工具
* 對遠端列印伺服器需具備系統管理的權限

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_7.png)

---

若列印伺服器的印表機共用沒有啟用的話，則該伺服器前面圖示也會有一個向下的紅色箭頭
若伺服器內已經有印表機被共用的話，其印表機共用會自動被啟用
若要檢視或變更印表機共用狀態的話：開始對著網路按右鍵內容變更進階共用設定檔案及印表機共用

# 8-3連接與使用共用印表機

* 按\+R鍵輸入\\\\server3\\EPSON AL\-M1400
  * 點擊左下角 __開始__ 圖示點擊 __設定__ 圖示裝置印表機與掃描器

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_8.png)

# 利用群組原則部署共用印表機

透過 __列印管理__ 主控台

電腦或使用者套用此原則後，就會自動安裝該印表機

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_9.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_10.png)

\* 也可以透過 __網路探索__ 或    __新增印表機精靈__

---

範例是透過Default Domain Policy來部署
套用原則：電腦重新啟動、手動執行GPUPDATE  /force指令或等其自動套用(一般用戶端需等90-120分鐘)

# 利用網頁瀏覽器來連接共用印表機

列印伺服器本身需為IIS網站

http://server3/printers或http://server3\.sayms\.local/printers/

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_11.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_12.png)

---

可透過新增角色來安裝網頁伺服器(IIS)

# 8-4 共用印表機的進階設定

多個邏輯印表機對應到同一台實體列印設備

1─優先順序最低，99─優先順序最高

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_13.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_14.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_15.png)

---

也可以使用列印管理主控台

# 設定印表機的列印時間

非急件或文件過於龐大，可以選擇特定時段再列印

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_16.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_17.png)

# 設定印表機集區

* 印表機會視列印設備的忙碌狀態來將文件送到其中一台列印設備
* 若有列印設備故障，正在列印的文件會被暫停，其它文件仍可透過其他正常的列印設備來列印
* 建議這幾台列印設備最好是放在鄰近地方

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_18.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_19.png)

  * \* 列印文件是被暫時儲存在   % _Systemroot_ %\\System32\\spool\\PRINTERS

---

或特性相同的印表機

# 8-5 印表機使用權限與擁有權

|                                                              印表機的權限<br />具備的能力 | 列印 | 管理文件 | 管理這部印表機 |
| :-: | :-: | :-: | :-: |
| 連接印表機與列印文件 |  |   |  |
| 暫停、繼續、重新開始與取消列印使用者自己的文件 |  |   |  |
| 暫停、繼續、重新開始與取消列印所有的文件 |   | (見附註) |  |
| 變更所有文件之列印順序、時間等設定 |   | (見附註) |  |
| 將印表機設定為共用印表機 |   |   |  |
| 變更印表機內容(properties) |   |   |  |
| 刪除印表機 |   |   |  |
| 變更印表機的權限 |   |   |  |

預設是Everyone都有 __列印__ 的權限

使用者被賦予 __管理文件__ 權限後，只能夠管理之後才送來的文件

預設擁有者是SYSTEM。擁有權的相關原理與檔案類似

# 內建分隔頁檔

__sysprint\.sep__ ：適用於與PostScript相容的列印設備

__pcl\.sep__ ：適用於與PCL相容的列印設備。它先會將列印設備切換到PCL模式（利用 \\H指令），然後再列印分隔頁。

__pscript\.sep__ ：適用於與PostScript相容的列印設備，用來將列印設備切換到PostScript模式（利用 \\H指令），但是不會列印分隔頁

__sysprtj\.sep__ ：日文版的sysprint\.sep

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_20.png)

# 分頁檔內可使用的命令

| 命令 | 功能 |
| :-: | :-: |
| \J | 列印送出此文件的使用者的網域名稱。僅Windows Server 2012(含)、Windows 8(含)之後的系統支援 |
| \N | 列印送出此文件的使用者名稱 |
| \I | 列印工作號碼(每一個文件都會被賦予一個工作號碼) |
| \D | 列印文件被列印出來時的日期 |
| \T | 列印文件被列印出來時的時間 |
| \L | 列印所有跟在\L後的文字，一直到遇到另一個命令符號為止 |
| \Fpathname | 由一個空白行的開頭，將pathname所指的檔案內容列印出來，此檔案不會經過任何處理，而是直接列印 |
| \Hnn | 送出印表機控制碼nn，此控制碼隨印表機而有不同的定義與功能，請參閱印表機手冊 |
| \Wnn | 設定分隔頁的列印寬度，內定為80，最大為256，超過設定值的字元會被截掉 |
| \U | 關掉區塊字元(block character)列印，它兼具跳到下一行的功能 |
| \B\S | 以單寬度區塊字元列印文字，直到遇到\U為止 |
| \B\M | 以雙寬度區塊字元列印文字，直到遇到\U為止 |
| \E | 跳頁 |
| \n | 跳n行(可由0到9)，n為0表示跳到下一行 |

---

\Fpathname中所指定的檔案請放置到以下資料夾之一，否則無法列印此檔案:
C:\Windows\System32、C:\Windows\System32\SepFiles，或是此資料夾之下的任何一個子資料夾內、自選資料夾之下的SepFiles資料夾內，例如C:\Test\SepFiles，或是此資料夾之下的任何一個子資料夾內

# 8-6 利用分隔頁來區隔列印文件

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_21.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_22.png)

# 選擇分隔頁檔

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_23.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_24.png)

# 8-7 管理等待列印的文件

暫停、繼續、重新開始、取消列印某份文件

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_25.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_26.png)

# 變更文件的列印優先順序與列印時間

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch08-%E6%9E%B6%E8%A8%AD%E5%88%97%E5%8D%B0%E4%BC%BA%E6%9C%8D%E5%99%A8_27.png)

