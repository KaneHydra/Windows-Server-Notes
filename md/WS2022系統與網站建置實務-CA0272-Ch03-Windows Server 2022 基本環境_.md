第 3 章 Windows Server 2022基本環境

3\-1  螢幕的顯示設定

3\-2  電腦名稱與TCP/IP設定

3\-3  安裝Windows Admin Center

3\-4  連接網際網路與啟用Windows系統

3\-5  Windows Defender 防火牆與網路位置

3\-6  環境變數的管理

3\-7  其他的環境設定

# 3-1  螢幕的顯示設定

* 調整顯示解析度與顯示顏色
  * 解析度1920\*1080：水平1920點、垂直1080點
  * 解析度愈高，畫面愈細膩，影像與物件的清晰度越佳
* 同時變更螢幕解析度、顯示顏色與螢幕更新頻率
  * 進階顯示設定

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_0.png)

# 3-2  電腦名稱與TCP/IP設定

* 電腦名稱：伺服器管理員本機伺服器
  * 網路上每一台電腦的電腦名稱必須是唯一的，不可重複
  * 建議將電腦名稱改為比較有意義的名稱
* 工作群組名稱
  * 預設是WORKGROUP

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_1.png)

# TCP/IP設定－自動取得IP位址

* 預設會自動向DHCP 伺服器租用
* DHCP伺服器
  * 一台提供DHCP伺服器的電腦
  * 一台具備DHCP伺服器功能的IP分享器、寬頻路由器、無線基地台等
* 若找不到DHCP伺服器的話
  * APIPA機制：169\.254\.0\.0/16格式的IP位址
  * 只能夠與同一個網路內也是使用169\.254\.0\.0/16格式的電腦溝通

# TCP/IP設定－手動設定IP位址

會增加系統管理員的負擔，而且手動設定容易出錯

比較適合於企業內部的伺服器來使用

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_2.png)

# 設定與檢視IP位址設定

* 設定IP位址：伺服器管理員
* 檢視IP位址的有效設定值
  * 伺服器管理員
  * 執行IPCONFIG 或IPCONFIG /ALL

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_3.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_4.png)

# 善用Ping指令來除錯 - 1

* 執行 __迴路測試__
  * 可驗證本機電腦的網路卡\(硬體\)與TCP/IP驅動程式\(軟體\)是否可以正常收、送TCP/IP的封包

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_5.png)

* Ping同一個網路區段內其他電腦的IP位址
  * 若對方已啟用 __Windows Defender __  __防火牆__ 的話，會出現 __要求等候逾時__ 的警告。若對方電腦不存在的話，也會出現類似警告

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_6.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_7.png)

* Ping預設閘道的IP位址
* Ping 位於其它網路內的遠端電腦
  * 此Ping指令的封包會透過預設閘道傳送到遠端電腦

# 3-3 安裝Windows Admin Center

下載與安裝Windows Admin Center：先暫時停止IE ESC

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_8.png)

\* 瀏覽器支援Microsoft Edge與   Google Chrome

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_9.png)

# 3-4  連接網際網路與啟用Windows系統

* 透過路由器或NAT上網
  * 將 __預設閘道__ 指定到路由器\(或NAT\)的IP位址
  * 指定DNS伺服器
* 透過代理伺服器上網
  * 透過 __網際網路選項__ 來指定代理伺服器
  * 透過ADSL或VDSL上網
    * 建立xDSL連線

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_10.png)

---

對著右下方工作列的網路圖示按右鍵開啟網路和網際網路設定網路和共用中心點擊設定新的連線或網路點擊連線到網際網路後按下一步鈕點擊寬頻（PPPoE）輸入用來連接ISP的帳戶與密碼

# 啟用Windows Server 2022

* 需執行 __啟用__ 程序，否則有的使用者個人化功能無法使用
  * 例如無法變更背景、色彩等

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_11.png)

---

期限過後，系統仍然可以正常運作

# 3-4  Windows Defender 防火牆與網路位置

* __Windows Defender __  __防火牆__ 可保護電腦，避免遭受惡意程式的攻擊
  * 不同網路位置可有不同的 __Windows Defender__  __防火牆__ 設定
  * 可透過下圖來變更設定或停用/啟用各網路位置的防火牆
* 網路位置分為 __私人網路__ 、 __公用網路__ 與 __網域網路__
  * 系統會自動判斷與
  * 設定電腦所在的網路位置

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_12.png)

---

點擊下方的開始圖示 設定圖示 更新與安全性（Windows 11為隱私權與安全性）Windows安全性防火牆與網路防護

# 變更網路位置

* 若要自行變更網路位置的話，例如從公用變更為私人
  * Get\-NetConnectionProfile
  * Set\-NetConnectionProfile \-Name “網路” \-NetworkCategory  Private

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_13.png)

# 解除對某些程式的封鎖

* 預設會阻擋絕大部分的連入連線
  * 例如要允許其他使用者來存取您電腦內的共用檔案與印表機

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_14.png)

---

透過前面圖中的允許程式或功能通過Windows 防火牆來設定

# Windows Defender防火牆的進階安全設定

可進一步設定防火牆規則

透過 __具有進階安全性的__  __ Windows Defender__  __防火牆__ 來設定

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_15.png)

---

開始Windows系統管理工具具有進階安全性的 Windows 防火牆
點擊前2圖中的進階設定


# 網路位置設定檔

* 不同的網路位置可有不同的防火牆規則設定，也有不同的設定檔
  * 封鎖\(預設\)：沒有被明確允許連線的所有連線都會被封鎖
  * 封鎖所有連線：封鎖全部連線，不論規則內是否允許連線
  * 允許：允許連線，但規則內封鎖的連線除外

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_16.png)

---

對著本機電腦上具有進階安全性的 Windows防火牆按右鍵內容

# 解除對某些程式的封鎖 - 1

* 若要開放其他電腦利用Ping指令來與您的電腦溝通的話
  * 輸入規則檔案及印表機共用（回應要求 – ICMPv4\-In）

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_17.png)

* 若服務或應用程式未列在清單中
  * 透過新增規則來開放

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_18.png)

# 3-7 環境變數的管理

* 執行Windows PowerShell 指令 __ __  __dir__  __ __  __env__  __:__ 或 __Get\-__  __Childitem__  __ __  __env__  __ : __
* 環境變數的設定規則
  * PATH:系統環境變數 \+ 使用者環境變數
  * 其他環境變數:系統環境變數  __←__  使用者環境變數

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_19.png)

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_20.png)

---

開始對著本機按右鍵內容進階系統設定點擊右下角的環境變數鈕

# 環境變數的使用

* Windows PowerShell
  * 在環境變數前加上 __$__  __env__  __:__
    * __$__  __env:username__

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_21.png)

# 3-9  其他的環境設定

* 系統支援Plug and Play\(隨插即用\)
  * 安裝新設備後，若系統支援該設備，就會自動安裝驅動程式
* 也可以透過【點擊左下角開始圖示設定圖示裝置藍牙與其他裝置】的途徑，來安裝無法被系統辨識的設備或未支援Plug and Play設備
* 可以利用 __裝置管理員__ 來管理設備
* 也可以在 __裝置管理員__ 畫面中【對著伺服器名稱按右鍵掃描硬體變更】，來掃描是否有新安裝的裝置

# 回復驅動程式

更新驅動程式後，若該程式有誤的話，可將之前的驅動程式再安裝回來

在 __裝置管理員__ 畫面中對著該設備按右鍵內容驅動程式回復驅動程式

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_22.png)

---

圖中的設備因為未曾更新過驅動程式，故無法選擇回復驅動程式

# 虛擬記憶體

  * 若實體記憶體不夠用的話，系統會透過硬碟的pagefile\.sys檔（又稱 __分頁檔__ ）來當作虛擬記憶體
* 硬碟存取速度比實體記憶體慢很多，因此若經常發生記憶體不夠使用的情況時，建議安裝更多的記憶體，以免電腦運作效率被硬碟拖慢

# 變更虛擬記憶體

開啟 __檔案總管__ 對著 __本機__ 按右鍵內容進階系統設定點擊 __效能__ 處的 __設定__ 鈕 __進階__ 標籤點擊 __變更__ 鈕

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_23.png)

# 顯示分頁檔pagefile.sys

* 分頁檔是受保護的作業系統檔案
  * 開啟 __檔案總管__  __檢視__ 功能表 __選項__  __檢視__ 標籤取消勾選 __隱藏保護的作業系統檔案__ 、勾選 __顯示隱藏的檔案、資料夾及磁碟機__

![](WS2022%E7%B3%BB%E7%B5%B1%E8%88%87%E7%B6%B2%E7%AB%99%E5%BB%BA%E7%BD%AE%E5%AF%A6%E5%8B%99-CA0272-Ch03-Windows%20Server%202022%20%E5%9F%BA%E6%9C%AC%E7%92%B0%E5%A2%83_24.png)

# 其他設定

若有多個顯示埠的話，則可連接多個顯示器來擴大工作桌面：【對著桌面空白處按右鍵顯示設定】

可透過 __工作管理員__ 來查看或管理應用程式、效能、使用者與服務等：【按Ctrl \+ Alt \+ Del 鍵】或【對著下方的工作列按右鍵】後選擇 __工作管理員__

為確保電腦的安全性與擁有良好效能，請定期更新系統：【點擊左下角的 __開始__ 圖示點擊 __設定__ 圖示更新與安全性】

建議定期重組磁碟，以便磁碟能夠保有較佳的存取效率：【開啟 __檔案總管__ 對著任一磁碟按右鍵內容點擊 __工具__ 標籤下的 __最佳化__ 鈕…】

