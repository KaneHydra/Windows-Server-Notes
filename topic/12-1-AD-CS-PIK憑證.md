---
id: 12-1-ADCS-PIK憑證
aliases: []
tags: []
---

# AD CS PKI 憑證

## 基本概念
　
如何確保一個電子商務網站的交易安全？  
除了賦予每位合法會員登入名稱與密碼之外，  
若能利用憑證，將可以更有效地保障雙方交易所傳遞的資訊安全。
　
### 公鑰加密法 (Public Key Cryptography)  
利用軟體或硬體產生一對獨特的金鑰（Key），  
其中一把稱為公鑰（Public Key），  
另一把稱為私鑰（Private Key）。  
利用公鑰所加密的資料，必須用相對應的私鑰才能解密；  
反之，利用私鑰所加密的資料，也必須用相對應的公鑰才能解密。  
如此，便能建構一種維護資料傳遞安全性的機制，  
通常公鑰是可以公諸於世地讓人使用，但私鑰則必須妥為保管，  
以免因洩漏而破壞整個保密機制。
　
### 憑證 (Certificate)  
為防止公鑰被冒充而造成困擾，  
可由具公信力機構替客戶製作專屬的一對金鑰，  
私鑰由客戶保管，公鑰則由該機構保管，  
並包裝成「憑證」以公諸於世。  
因此，憑證可以說是公鑰的證明文件，  
又稱為「公鑰憑證」（Public Key Certificate）  
或「數位憑證」（Digital Certificate）。
　
　
欲使用憑證，  
可到憑證授權單位（CA，Certificate Authority）申請，  
或自行架設 CA 伺服器，對用戶端或網站發放憑證。  
在 Windows Server 2003 R2 之 Certificate Services 中，  
CA 的架構屬階層式（Hierarchical），  
最上層的 CA 稱為「根（Root）CA」，  
其下的 CA 都是「次級（Subordinate）CA」（如下圖），  
次級 CA 必須向根 CA 申請憑證，  
取得核發憑證的資格後，才能發憑證給用戶端。
　
- 根 CA
    - 次級 CA
    - 次級 CA
    - 次級 CA
       
　
※知名的 Root CA 有 VeriSign（http://www.verisign.com）、  
    Thawte（http://www.thawte.com）  
    和 Entrust（http://www.entrust.com）等機構。
　

AD CS 中發放的憑證分為兩類：  
伺服器憑證及用戶憑證，  
兩者都必須經過CA的認證，  
CA會將這些憑證列為清單，  
以此清單來控制憑證的有效期或取消憑證。  

AD CS 要發放憑證需架憑證伺服器提供用戶端申請憑證  

### 1. 憑證伺服器  

憑證伺服器分為兩類：  

*企業CA* 和 *獨立CA*
　
| 授權單位 | 說明                                                 |
| -------- | ---------------------------------------------------- |
| 企業 CA  | 必須有 AD 網域，且安裝在網域控制站或成員伺服器       |
| 獨立 CA  | 無需 AD 網域，只要是 Windows Server 2003 R2 即可安裝 |

　
綜合而言，  
CA 的類型可分為「企業根 CA」、「企業次級 CA」、「獨立根 CA」與「獨立次級 CA」4 種。


### 用戶端
用戶端申請憑證使用兩種方法:

- 憑證註冊精靈: 必須是網域帳戶較簡單
- 網頁申請: 必須有三個程序較麻煩
    - 安裝憑證授權單位網頁註冊
    - 信任憑證授權單位申請憑證  
        (用戶端要信任憑證授權單位才可申請憑證，若已加入網域就不需要)
    - 申請和安裝憑證


### AD CS 中的角色服務
憑證授權單位  
線上回應服務  
網路裝置註冊服務



## AD CS

「Active Directory Certificate Services」 是以「PKI」為基礎的「安全性通訊協定」，  
「SSL (Secure Socket Layer)」也是同樣。  

無論是「電子郵件保護」或「SSL」網站安全連線，  
都被必須申請「憑證(Certification)」，  
才可以使用「公開金鑰」來執行資料「加密」與「身分驗證」的動作，  
憑證就好像是「汽車駕駛」一樣，  
必須擁有「汽車駕駛執照 (憑證)」才能開車 (使用金鑰)。  
而負責發放憑證的機構被稱為「憑證授權單位 (Certification Authority，CA)」。  


## 公鑰與私鑰
使用者或網站的「公開金鑰」與「私密金鑰」是如何產生的呢? 在申請「憑證」時，  
需要輸入「姓名」、「地址」、「電子郵件信箱」..等資料，  
這些程式會被傳送到一個稱為「CSP (Cryptographic Service Provider)」的程式，  
此程式已經被安裝在申請者的「電腦內」或 此「電腦可以存取的設備內」。  


## CA 角色
如果使用「Active Directory Certificate Services」來提供「CA」服務的話，  
則您可以選擇將「CA」設定為下面角色:

### 「企業根 Enterprise root CA」
企業根「CA」需要「Active Directory」網域，  
您可以將企業根「CA」安裝到「網域控制站」或「成員伺服器」。  
企業根「CA」發放憑證的對象僅限「網域使用者」，  
當「網域 使用者」來申請「憑證」時，  
企業根「CA」可以從「Active Directory」來得知該「使用者」的「相關資訊」，  
並據以決定使用者「是/否」有「權利來申請所需憑證」。  

大部份情況之下，  
企業根「CA」主要應該是用來發放「憑證」給「次級CA」，  
雖然 「企業」根 CA 還是可以發放「保護電子郵件安全」、「網站 SSL 安全連線」等憑證，  
不過應該將發放這些「憑證」的工作交付給「次級 CA」來負責。  

「企業次級 Enterprise subordinate CA」
「企業次級 CA」 也需要「Active Directory」網域，  
「企業次級 CA」適合用於來發放「保護電子郵件安全」、「網站 SSL 安全連線」等憑證。  
「企業次級 CA」必須向其「父系 CA (例如企業根 CA) 取得憑證以後」，  
才會正常運作，  
「企業次級 CA」也可以發放憑證給再下一層的「次級CA」。  


### 「獨立根 Standalone root CA」
「獨立 根 CA」的腳色與功類似於「企業根CA」，  
但不需要「Active Directory」網域，  
扮演「獨立 根 CA」腳色的電腦，  
都可以是「獨立的伺服器」、「成員伺服器」或「網域控制站」，  
無論「是/否」網域「使用者」，  
都可以向「獨立 根 CA」，  
申請憑證。  


### 「獨立次級 Standalone subordinate CA」
「獨立 次級 CA」的腳色與功類似於「企業次級 CA」，  
但不需要「Active Directory」網域，  
扮演「獨立 次級 CA」腳色的「電腦」可以是「獨立伺服器」、「成員伺服器」、「網域控制站」。  
無論「是/否」 網域使用者，  
都可以向「獨立 次級 CA」申請憑證。  

